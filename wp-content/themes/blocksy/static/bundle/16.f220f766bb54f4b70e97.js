(window.blocksyJsonP=window.blocksyJsonP||[]).push([[16],{32:function(e,t,r){"use strict";r.r(t),r.d(t,"mount",(function(){return u}));var i=r(3),a=r.n(i),o=r(0),n=r.n(o),c=r(5);let l=null;const s={},d=e=>{let{variation:t,productId:r,isQuickView:i}=e,a=new URL(ct_localizations.ajax_url),o=new URLSearchParams(a.search.slice(1));return o.append("action","blocksy_get_product_view_for_variation"),o.append("variation_id",t.variation_id),o.append("product_id",r),o.append("is_quick_view",i),a.search="?"+o.toString(),a.toString()},u=e=>{a.a&&a.a.fn&&a.a.fn.wc_variations_image_update&&(l=a.a.fn.wc_variations_image_update,a.a.fn.wc_variations_image_update=function(t){const r=e.closest(".product").querySelector(".woocommerce-product-gallery");let i=r.closest(".type-product"),a="no",o=i.id.replace("product-","");o||(o=r.closest('[class*="ct-quick-view"]').querySelector("[data-product_id]").dataset.product_id,o&&(a="yes"));const l=JSON.parse(e.dataset.product_variations);let u=!1,_=!1,y=!1;if(l&&(u=!!t.variation_id&&l.find(e=>{let{variation_id:r}=e;return parseInt(r)===parseInt(t.variation_id)}),_=!!r.dataset.currentVariation&&l.find(e=>{let{variation_id:t}=e;return parseInt(t)===parseInt(r.dataset.currentVariation)}),y=r.querySelector(".flexy-items")&&(!_||_&&r.querySelector(`.flexy-items [srcset*="${_.image.src}"]`)&&"default"===_.blocksy_gallery_source&&[...r.querySelector(".flexy-items").children].indexOf(r.querySelector(`.flexy-items [srcset*="${_.image.src}"]`).closest("div"))>0)),!t.variation_id&&!r.dataset.currentVariation)return;if(parseInt(t.variation_id)===parseInt(r.dataset.currentVariation))return;if(t.variation_id?r.dataset.currentVariation=t.variation_id:r.removeAttribute("data-current-variation"),_&&u&&"default"===u.blocksy_gallery_source&&"default"===_.blocksy_gallery_source&&u.image_id===_.image_id)return;if(l&&r.querySelector("[data-flexy]")&&y&&(!u||"default"===u.blocksy_gallery_source)){let e=null,i=0;t&&(e=r.querySelector(`.flexy-items [srcset*="${t.image.src}"]`),e&&(i=[...r.querySelector(".flexy-items").children].indexOf(e.closest("div"))));const a=r.querySelector(".flexy-pills > *").children[i];if((!t||t&&e)&&a)return r.querySelector("[data-flexy]").dataset.flexy.indexOf("no")>-1?(r.querySelector("[data-flexy]").forcedMount&&r.querySelector("[data-flexy]").forcedMount(),void setTimeout(()=>{a.click()},500)):void a.click()}const f=e=>{const t=document.createElement("div");t.innerHTML=e,r.innerHTML=t.firstElementChild.innerHTML,Object(c.a)(r),r.hasLazyLoadClickHoverListener=!1,setTimeout(()=>{n.a.trigger("blocksy:frontend:init"),r.removeAttribute("data-state")})};if(t.blocksy_gallery_html)return void f(t.blocksy_gallery_html);r.removeAttribute("style"),requestAnimationFrame(()=>{r.dataset.state="loading"});let m=l?l.find(e=>s[d({variation:e,productId:o,isQuickView:a})]&&e.image_id===t.image_id&&"default"===t.blocksy_gallery_source&&"default"===e.blocksy_gallery_source):null;var p;(p=d({variation:m||t,productId:o,isQuickView:a}),s[p]?new Promise(e=>{e(s[p]),s[p]=s[p].clone()}):new Promise(e=>fetch(p).then(t=>{e(t),s[p]=t.clone()}))).then(e=>e.json()).then(e=>{let{success:t,data:r}=e;t&&f(r.html)})})}}}]);